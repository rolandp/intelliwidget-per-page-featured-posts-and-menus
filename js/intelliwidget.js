jQuery(document).ready(function(a){a("body").on("click",".iw-collapsible",function(){id=a(this).attr("id");sel="#"+id+"-inside";a(sel).stop().slideToggle()});a("body").on("click",".iw-save",iw_save_postdata);a("body").on("click",".iw-cdfsave",iw_save_cdfdata);a("body").on("click",".iw-copy",iw_copy_page);a("body").on("click",".iw-add",iw_add_meta_box);a("body").on("click",".iw-delete",iw_delete_meta_box);b("intelliwidget_event_date",false);b("intelliwidget_expire_date",false);a("body").on("click","a.intelliwidget-edit-timestamp",function(){var c=a(this).attr("id").split("-",1);if(a("#"+c+"_div").is(":hidden")){a("#"+c+"_div").slideDown("fast");a("#"+c+"_mm").focus();a(this).hide()}return false});a("body").on("click",".intelliwidget-clear-timestamp",function(){var c=a(this).attr("id").split("-",1);a("#"+c+"_div").slideUp("fast");a("#"+c+"_mm").val(a("#"+c+"_cur_mm").val());a("#"+c+"_jj").val(a("#"+c+"_cur_jj").val());a("#"+c+"_aa").val(a("#"+c+"_cur_aa").val());a("#"+c+"_hh").val(a("#"+c+"_cur_hh").val());a("#"+c+"_mn").val(a("#"+c+"_cur_mn").val());a("#"+c+"_timestamp").html("");a("#"+c).val("");a("a#"+c+"-edit").show();b(c,false);return false});a("body").on("click",".intelliwidget-cancel-timestamp",function(){var c=a(this).attr("id").split("-",1);a("#"+c+"_div").slideUp("fast");a("#"+c+"_mm").val(a("#"+c+"_hidden_mm").val());a("#"+c+"_jj").val(a("#"+c+"_hidden_jj").val());a("#"+c+"_aa").val(a("#"+c+"_hidden_aa").val());a("#"+c+"_hh").val(a("#"+c+"_hidden_hh").val());a("#"+c+"_mn").val(a("#"+c+"_hidden_mn").val());a("a#"+c+"-edit").show();b(c,false);return false});a("body").on("click",".intelliwidget-save-timestamp",function(){var c=a(this).attr("id").split("-",1);if(b(c,true)){a("#"+c+"_div").slideUp("fast");a("a#"+c+"-edit").show()}return false});function b(l,k){var i,d="#"+l+"_div",j=(!k&&!a("#"+l).val()),c=a("#"+l+"_aa").val(),g=("00"+a("#"+l+"_mm").val()).slice(-2),h=("00"+a("#"+l+"_jj").val()).slice(-2),f=("00"+a("#"+l+"_hh").val()).slice(-2),e=("00"+a("#"+l+"_mn").val()).slice(-2);if(!a(d).length){return true}i=new Date(c,g-1,h,f,e);if(i.getFullYear()!=c||(1+i.getMonth())!=g||i.getDate()!=h||i.getMinutes()!=e){if(k==true){a(d).addClass("form-invalid");a(".iw-cdfsave").attr("disabled","disabled");return false}j=true}a(d).removeClass("form-invalid");a(".iw-cdfsave").removeAttr("disabled");if(j){a("#"+l+"_timestamp").html("");a("#"+l).val("")}else{a("#"+l+"_timestamp").html("<b>"+a('option[value="'+a("#"+l+"_mm").val()+'"]',"#"+l+"_mm").text()+" "+h+", "+c+" @ "+f+":"+e+"</b> ");a("#"+l).val(c+"-"+a("#"+l+"_mm").val()+"-"+h+" "+f+":"+e)}return true}});var iw_save_cdfdata=function(){jQuery(this).attr("disabled","disabled");jQuery(".iw-copy-container,.iw-save-container,.iw-cdf-container").removeClass("success failure");jQuery("body").off("click","#iw_cdfsave",iw_save_cdfdata);jQuery("#intelliwidget_cpt_spinner").show();var a={};jQuery("input[name=post_ID],input[name=iwpage],.intelliwidget-input").each(function(b,c){fieldID=jQuery(this).attr("id");a[fieldID]=jQuery(this).val()});a.action="iw_cdfsave";jQuery.post(IWAjax.ajaxurl,a,function(b){jQuery("#iw_cdfsave").removeAttr("disabled");jQuery("#intelliwidget_cpt_spinner").hide();jQuery(".iw-cdf-container").addClass("success");return false});return false},iw_save_postdata=function(){jQuery(this).attr("disabled","disabled");jQuery(".iw-copy-container,.iw-save-container,.iw-cdf-container").removeClass("success failure");var a=jQuery(this).attr("id");sel="#"+a,pre="intelliwidget_"+a.split("_")[1],postData={};jQuery("#"+pre+"_spinner").show();jQuery("body").off("click",sel,iw_save_postdata);postData[pre+"_post_types"]=[];jQuery("input[name=post_ID],input[name=iwpage],input[type=text][id^="+pre+"],input[type=checkbox][id^="+pre+"]:checked,select[id^="+pre+"],textarea[id^="+pre+"]").each(function(b,c){fieldID=jQuery(this).attr("id");if(fieldID.indexOf("_post_types")>0){postData[fieldID].push(jQuery(this).val())}else{postData[fieldID]=jQuery(this).val()}});postData.action="iw_save";jQuery.post(IWAjax.ajaxurl,postData,function(b){jQuery(sel).removeAttr("disabled");jQuery("#"+pre+"_spinner").hide();jQuery(sel).parent().addClass("success");return false});return false},iw_copy_page=function(){jQuery(this).attr("disabled","disabled");jQuery(".iw-copy-container,.iw-save-container,.iw-cdf-container").removeClass("success failure");jQuery("body").off("click","#iw_copy",iw_copy_page);jQuery("#intelliwidget_spinner").show();var a={};jQuery("input[name=post_ID],input[name=iwpage],select[id=intelliwidget_widget_page_id]").each(function(b,c){fieldID=jQuery(this).attr("id");a[fieldID]=jQuery(this).val()});a.action="iw_copy";jQuery.post(IWAjax.ajaxurl,a,function(b){jQuery("#iw_copy").removeAttr("disabled");jQuery("#intelliwidget_spinner").hide();jQuery(".iw-copy-container").addClass("success");return false});return false},iw_add_meta_box=function(d){d.stopPropagation();if(jQuery(this).hasClass("disabled")){return false}jQuery(this).addClass("disabled");jQuery(".iw-copy-container,.iw-save-container,.iw-cdf-container").removeClass("success failure");var f=jQuery(this).attr("id"),c="#"+f,b=jQuery(this).attr("href"),a=iw_url_to_array(b);jQuery("#intelliwidget_spinner").show();a.action="iw_add";jQuery.post(IWAjax.ajaxurl,a,function(e){jQuery(c).removeClass("disabled");jQuery("#intelliwidget_spinner").hide();if(e=="fail"){jQuery(".iw-copy-container").addClass("failure")}else{jQuery("#side-sortables").append(e);jQuery("body").on("click",".iw_new_box h3, .iw_new_box .handlediv, .iw_new_box .postbox h3, .iw_new_box .postbox .handlediv",function(){var g=jQuery(this).parent(".postbox"),h=g.attr("id");g.toggleClass("closed");if(h){if(!g.hasClass("closed")&&jQuery.isFunction(postboxes.pbshow)){postboxes.pbshow(h)}else{if(g.hasClass("closed")&&jQuery.isFunction(postboxes.pbhide)){postboxes.pbhide(h)}}}});jQuery("body").on(".iw_new_box h3 a, .iw_new_box .postbox h3 a","click",function(g){g.stopPropagation()});jQuery(".iw-copy-container").addClass("success")}return false});return false},iw_delete_meta_box=function(f){f.stopPropagation();if(jQuery(this).hasClass("disabled")){return false}jQuery(this).addClass("disabled");jQuery(".iw-copy-container,.iw-save-container,.iw-cdf-container").removeClass("success failure");var g=jQuery(this).attr("id"),c="#"+g,b=jQuery(this).attr("href"),a=iw_url_to_array(b),d=a.iwdelete;jQuery("#intelliwidget_"+d+"_spinner").show();a.action="iw_delete";jQuery.post(IWAjax.ajaxurl,a,function(e){jQuery(c).removeClass("disabled");jQuery("#intelliwidget_"+d+"_spinner").hide();if(e=="success"){jQuery("#intelliwidget_section_meta_box_"+d).slideUp("fast",function(){jQuery("#intelliwidget_section_meta_box_"+d).remove()})}return false});return false};function iw_url_to_array(a){var e,b,c={},d=a.substring(a.indexOf("?")+1).split("&");for(b=0;b<d.length;b++){e=d[b].split("=");c[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return c};